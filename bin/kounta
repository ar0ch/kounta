#!/usr/bin/env perl
use 5.26.0;
use strict;
use FindBin;
use lib "$FindBin::RealBin/../perl5";
use Biotool::Getopt;
use Biotool::Logger;
use Biotool::Binaries;
use Data::Dumper;

sub main {

  my $opt = Biotool::Getopt->getopt( 
  {
    name => 'kounta',
    version => '0.0.1',
    desc => 'Build a k-mer presence matrix for many genomes',
    url => 'https://github.com/tseemann/kounta',
  },
  {
    outmatrix => { type=>'file', need=>1 },
    kmer => { type=>'int', default=>25, need=>1, desc=>"k-mer length" },
    threads => { type=>'int', default=>1, need=>1, desc=>"Threads to use" },
    minfreq => { type=>'int', default=>5, need=>1, desc=>"Min k-mer frequency to include" },
    binary => { type=>'', desc=>"Output binary presence/absence instead of counts" },
  });

  print Dumper($opt);

  require_exe($_) for qw(sort uniq join paste head tail kmc kmc_dump kmc_tools);
  return if $opt->{check};

  map { -r $_ or err("Can't read input file '$_'") } $opt->{ARGV}->@*;
}

exit main(@ARGV);
